<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humedal Santa Mar√≠a del Lago - Experiencia 3D</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        
        #container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        .ui-panel {
            position: absolute;
            background: rgba(0, 20, 40, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            color: white;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }
        
        .control-panel {
            top: 20px;
            left: 20px;
            width: 280px;
        }
        
        .data-panel {
            top: 20px;
            right: 20px;
            width: 300px;
            max-height: 80vh;
            overflow-y: auto;
            display: none;
        }
        
        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 12px 20px;
            margin: 8px 0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .button.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .sensor-data {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #4CAF50;
        }
        
        .sensor-value {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .sensor-label {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .info-panel {
            bottom: 20px;
            left: 20px;
            width: 300px;
        }
        
        h1 {
            color: #4CAF50;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        h2 {
            color: #81C784;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 200;
        }
        
        .species-counter {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            z-index: 100;
        }

        .thermal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 40%, rgba(255, 100, 100, 0.3) 0%, transparent 30%),
                       radial-gradient(circle at 70% 60%, rgba(255, 200, 100, 0.3) 0%, transparent 25%),
                       radial-gradient(circle at 50% 80%, rgba(100, 255, 100, 0.3) 0%, transparent 20%);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: 50;
        }

        .thermal-overlay.active {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="container">
        <div class="loading" id="loading">Cargando Humedal Santa Mar√≠a del Lago...</div>
        
        <div class="species-counter" id="speciesCounter">
            ü¶Ü Tinguas detectadas: <span id="tinguaCount">0</span>
        </div>

        <div class="thermal-overlay" id="thermalOverlay"></div>
        
        <div class="ui-panel control-panel">
            <h1>üåø Control de Monitoreo</h1>
            
            <button class="button" id="satelliteBtn">
                üõ∞Ô∏è Datos Satelitales
            </button>
            
            <button class="button" id="droneBtn">
                üöÅ Drone Biodiversidad
            </button>
            
            <button class="button" id="thermalBtn">
                üå°Ô∏è Drone T√©rmico
            </button>
            
            <button class="button" id="sensorsBtn">
                üìä Sensores Ambientales
            </button>
            
            <button class="button" id="resetBtn">
                üîÑ Vista Normal
            </button>
        </div>
        
        <div class="ui-panel data-panel" id="dataPanel">
            <h1>üìä Datos en Tiempo Real</h1>
            <div id="dataContent"></div>
        </div>
        
        <div class="ui-panel info-panel">
            <h1>üèûÔ∏è Humedal Santa Mar√≠a del Lago</h1>
            <p>Ecosistema urbano vital de Bogot√°</p>
            <p><strong>√Årea:</strong> 11.18 hect√°reas</p>
            <p><strong>Altitud:</strong> 2,550 m.s.n.m.</p>
            <p><strong>Especies:</strong> 120+ registradas</p>
        </div>
    </div>

    <script>
        // Variables globales
        let scene, camera, renderer, controls;
        let tinguas = [];
        let tinguaCount = 0;
        let currentDataMode = null;
        let animationFrame;

        // Datos simulados de sensores
        const sensorData = {
            satellite: {
                title: "üõ∞Ô∏è Datos Satelitales",
                data: [
                    { label: "Cobertura Vegetal", value: "78%", unit: "" },
                    { label: "√Årea de Agua", value: "4.2", unit: "hect√°reas" },
                    { label: "√çndice de Vegetaci√≥n", value: "0.72", unit: "NDVI" },
                    { label: "Cambio Anual", value: "+2.3%", unit: "" }
                ]
            },
            drone: {
                title: "üöÅ Detecci√≥n de Biodiversidad",
                data: [
                    { label: "Aves Detectadas", value: "23", unit: "especies" },
                    { label: "Tinguas Azules", value: "8", unit: "individuos" },
                    { label: "Patos Zambullidores", value: "12", unit: "individuos" },
                    { label: "Vegetaci√≥n Acu√°tica", value: "85%", unit: "cobertura" }
                ]
            },
            thermal: {
                title: "üå°Ô∏è Detecci√≥n T√©rmica",
                data: [
                    { label: "Fauna Nocturna", value: "15", unit: "detecciones" },
                    { label: "Temp. Superficie", value: "18.5¬∞C", unit: "" },
                    { label: "Zonas Calientes", value: "3", unit: "√°reas" },
                    { label: "Actividad Animal", value: "Alta", unit: "" }
                ]
            },
            sensors: {
                title: "üìä Sensores Ambientales",
                data: [
                    { label: "Humedad Relativa", value: "82%", unit: "" },
                    { label: "pH del Agua", value: "7.2", unit: "" },
                    { label: "Temperatura", value: "16.8¬∞C", unit: "" },
                    { label: "Ox√≠geno Disuelto", value: "8.4", unit: "mg/L" }
                ]
            }
        };

        // Inicializaci√≥n
        function init() {
            // Crear escena
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x87CEEB, 50, 200);
            
            // Configurar c√°mara
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(30, 25, 30);
            
            // Configurar renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.setClearColor(0x87CEEB, 1);
            document.getElementById('container').appendChild(renderer.domElement);
            
            // Controles de c√°mara b√°sicos
            setupCameraControls();
            
            // Crear el humedal
            createWetland();
            
            // Crear lighting
            setupLighting();
            
            // Crear tinguas
            createTinguas();
            
            // Setup UI
            setupUI();
            
            // Iniciar animaci√≥n
            animate();
            
            // Ocultar loading
            document.getElementById('loading').style.display = 'none';
        }

        function setupCameraControls() {
            let mouseX = 0, mouseY = 0;
            let targetX = 0, targetY = 0;
            
            document.addEventListener('mousemove', (event) => {
                mouseX = (event.clientX - window.innerWidth / 2) * 0.0001;
                mouseY = (event.clientY - window.innerHeight / 2) * 0.0001;
            });
            
            function updateCamera() {
                targetX += (mouseX - targetX) * 0.02;
                targetY += (mouseY - targetY) * 0.02;
                
                camera.position.x = Math.cos(Date.now() * 0.0005 + targetX * 5) * 40;
                camera.position.z = Math.sin(Date.now() * 0.0005 + targetX * 5) * 40;
                camera.position.y = 25 + targetY * 10;
                
                camera.lookAt(0, 0, 0);
                
                requestAnimationFrame(updateCamera);
            }
            updateCamera();
        }

        function createWetland() {
            // Crear el lago principal
            const lakeGeometry = new THREE.CircleGeometry(20, 32);
            const lakeMaterial = new THREE.MeshPhongMaterial({
                color: 0x4169E1,
                transparent: true,
                opacity: 0.8,
                shininess: 100
            });
            const lake = new THREE.Mesh(lakeGeometry, lakeMaterial);
            lake.rotation.x = -Math.PI / 2;
            lake.position.y = 0.1;
            lake.receiveShadow = true;
            scene.add(lake);

            // Crear vegetaci√≥n alrededor del lago
            createVegetation();
            
            // Crear senderos
            createPaths();
            
            // Crear peque√±as islas
            createIslands();
        }

        function createVegetation() {
            // Juncos y vegetaci√≥n acu√°tica
            for (let i = 0; i < 150; i++) {
                const angle = Math.random() * Math.PI * 2;
                const distance = 18 + Math.random() * 15;
                const x = Math.cos(angle) * distance;
                const z = Math.sin(angle) * distance;
                
                // Juncos
                const reedGeometry = new THREE.CylinderGeometry(0.1, 0.15, 2 + Math.random() * 3, 8);
                const reedMaterial = new THREE.MeshLambertMaterial({ color: 0x228B22 });
                const reed = new THREE.Mesh(reedGeometry, reedMaterial);
                reed.position.set(x, 1, z);
                reed.castShadow = true;
                scene.add(reed);
            }

            // √Årboles m√°s grandes
            for (let i = 0; i < 30; i++) {
                const angle = Math.random() * Math.PI * 2;
                const distance = 25 + Math.random() * 10;
                const x = Math.cos(angle) * distance;
                const z = Math.sin(angle) * distance;
                
                // Tronco
                const trunkGeometry = new THREE.CylinderGeometry(0.5, 0.8, 6, 8);
                const trunkMaterial = new THREE.MeshLambertMaterial({ color: 0x8B4513 });
                const trunk = new THREE.Mesh(trunkGeometry, trunkMaterial);
                trunk.position.set(x, 3, z);
                trunk.castShadow = true;
                scene.add(trunk);
                
                // Copa del √°rbol
                const crownGeometry = new THREE.SphereGeometry(3, 16, 16);
                const crownMaterial = new THREE.MeshLambertMaterial({ color: 0x32CD32 });
                const crown = new THREE.Mesh(crownGeometry, crownMaterial);
                crown.position.set(x, 7, z);
                crown.castShadow = true;
                scene.add(crown);
            }
        }

        function createPaths() {
            // Sendero principal
            const pathGeometry = new THREE.PlaneGeometry(3, 80);
            const pathMaterial = new THREE.MeshLambertMaterial({ color: 0xD2B48C });
            const path = new THREE.Mesh(pathGeometry, pathMaterial);
            path.rotation.x = -Math.PI / 2;
            path.position.y = 0.05;
            path.receiveShadow = true;
            scene.add(path);
        }

        function createIslands() {
            for (let i = 0; i < 3; i++) {
                const angle = (i / 3) * Math.PI * 2;
                const distance = 8 + Math.random() * 5;
                const x = Math.cos(angle) * distance;
                const z = Math.sin(angle) * distance;
                
                const islandGeometry = new THREE.CircleGeometry(2, 16);
                const islandMaterial = new THREE.MeshLambertMaterial({ color: 0x8FBC8F });
                const island = new THREE.Mesh(islandGeometry, islandMaterial);
                island.rotation.x = -Math.PI / 2;
                island.position.set(x, 0.2, z);
                scene.add(island);
            }
        }

        function setupLighting() {
            // Luz ambiental
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            
            // Luz direccional (sol)
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(50, 50, 50);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);
        }

        function createTinguas() {
            for (let i = 0; i < 8; i++) {
                const tingua = createTingua();
                tinguas.push(tingua);
                scene.add(tingua.group);
            }
            updateTinguaCounter();
        }

        function createTingua() {
            const group = new THREE.Group();
            
            // Cuerpo de la tingua
            const bodyGeometry = new THREE.SphereGeometry(0.8, 16, 16);
            const bodyMaterial = new THREE.MeshPhongMaterial({ color: 0x2F4F4F });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.scale.set(1, 0.8, 1.2);
            body.castShadow = true;
            group.add(body);
            
            // Cabeza
            const headGeometry = new THREE.SphereGeometry(0.4, 16, 16);
            const headMaterial = new THREE.MeshPhongMaterial({ color: 0x000080 });
            const head = new THREE.Mesh(headGeometry, headMaterial);
            head.position.set(0, 0.5, 0.8);
            head.castShadow = true;
            group.add(head);
            
            // Pico
            const beakGeometry = new THREE.ConeGeometry(0.1, 0.4, 8);
            const beakMaterial = new THREE.MeshPhongMaterial({ color: 0xFFFF00 });
            const beak = new THREE.Mesh(beakGeometry, beakMaterial);
            beak.position.set(0, 0.5, 1.1);
            beak.rotation.x = Math.PI / 2;
            group.add(beak);
            
            // Posici√≥n inicial aleatoria
            const angle = Math.random() * Math.PI * 2;
            const distance = 5 + Math.random() * 10;
            group.position.set(
                Math.cos(angle) * distance,
                0.5,
                Math.sin(angle) * distance
            );
            
            return {
                group: group,
                speed: 0.01 + Math.random() * 0.02,
                direction: Math.random() * Math.PI * 2,
                changeTimer: 0
            };
        }

        function animateTinguas() {
            tinguas.forEach(tingua => {
                // Cambiar direcci√≥n ocasionalmente
                tingua.changeTimer += 1;
                if (tingua.changeTimer > 200 + Math.random() * 200) {
                    tingua.direction += (Math.random() - 0.5) * 0.5;
                    tingua.changeTimer = 0;
                }
                
                // Mover tingua
                const newX = tingua.group.position.x + Math.cos(tingua.direction) * tingua.speed;
                const newZ = tingua.group.position.z + Math.sin(tingua.direction) * tingua.speed;
                
                // Mantener dentro del √°rea del lago
                const distanceFromCenter = Math.sqrt(newX * newX + newZ * newZ);
                if (distanceFromCenter < 18) {
                    tingua.group.position.x = newX;
                    tingua.group.position.z = newZ;
                    
                    // Rotar hacia la direcci√≥n de movimiento
                    tingua.group.rotation.y = tingua.direction;
                } else {
                    // Cambiar direcci√≥n si est√° fuera del l√≠mite
                    tingua.direction += Math.PI;
                }
                
                // Animaci√≥n de nataci√≥n
                tingua.group.position.y = 0.5 + Math.sin(Date.now() * 0.005 + tingua.group.position.x) * 0.1;
            });
        }

        function updateTinguaCounter() {
            document.getElementById('tinguaCount').textContent = tinguas.length;
        }

        function setupUI() {
            // Botones de control
            document.getElementById('satelliteBtn').addEventListener('click', () => showData('satellite'));
            document.getElementById('droneBtn').addEventListener('click', () => showData('drone'));
            document.getElementById('thermalBtn').addEventListener('click', () => showData('thermal'));
            document.getElementById('sensorsBtn').addEventListener('click', () => showData('sensors'));
            document.getElementById('resetBtn').addEventListener('click', hideData);
        }

        function showData(type) {
            // Actualizar estado de botones
            document.querySelectorAll('.button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(type + 'Btn').classList.add('active');
            
            currentDataMode = type;
            
            // Mostrar panel de datos
            const dataPanel = document.getElementById('dataPanel');
            const dataContent = document.getElementById('dataContent');
            
            dataContent.innerHTML = `
                <h2>${sensorData[type].title}</h2>
                ${sensorData[type].data.map(item => `
                    <div class="sensor-data">
                        <div class="sensor-label">${item.label}</div>
                        <div class="sensor-value">${item.value} ${item.unit}</div>
                    </div>
                `).join('')}
            `;
            
            dataPanel.style.display = 'block';
            
            // Efectos especiales seg√∫n el tipo
            if (type === 'thermal') {
                document.getElementById('thermalOverlay').classList.add('active');
            } else {
                document.getElementById('thermalOverlay').classList.remove('active');
            }
        }

        function hideData() {
            document.querySelectorAll('.button').forEach(btn => btn.classList.remove('active'));
            document.getElementById('dataPanel').style.display = 'none';
            document.getElementById('thermalOverlay').classList.remove('active');
            currentDataMode = null;
        }

        function animate() {
            animationFrame = requestAnimationFrame(animate);
            
            // Animar tinguas
            animateTinguas();
            
            // Simular ondas en el agua
            scene.children.forEach(child => {
                if (child.material && child.material.color && child.material.color.getHex() === 0x4169E1) {
                    child.position.y = 0.1 + Math.sin(Date.now() * 0.002) * 0.05;
                }
            });
            
            // Renderizar
            renderer.render(scene, camera);
        }

        // Manejar redimensionamiento
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // Iniciar aplicaci√≥n
        init();
    </script>
</body>
</html>
